programa ejercicio1D
procesos
  proceso juntarFlores(ES f:numero)
  comenzar
    mientras(HayFlorEnLaEsquina)
      tomarFlor
      f:=f + 1
  fin

  proceso recorrerArea(ES f:numero)
  comenzar
    repetir 9
      juntarFlores(f)
      mover
    juntarFlores(f)
  fin
  
  proceso asignarId
  comenzar
    EnviarMensaje(1, r1)
    EnviarMensaje(2, r2)
    EnviarMensaje(3, r3) 
    EnviarMensaje(4, r4)
    EnviarMensaje(5, r5)
    EnviarMensaje(6, r6)
  fin

  proceso actualizarMaximo(E f:numero; ES max:numero; E idRobot:numero; ES idGanador:numero)
  comenzar
    si(f > max)
      max:=f
      idGanador:=idRobot
  fin

  proceso informarGanador(E idGanador:numero)
  comenzar
    si(idGanador > 0)
      Informar('Robot ganador',idGanador)
    sino
      Informar('No hay ganador ', 0)
  fin
  
areas
  ciudad1: AreaP (1,1,1,10)
  ciudad2: AreaP (2,11,2,20)
  ciudad3: AreaP (3,21,3,30)
  ciudad4: AreaP (4,31,4,40)
  ciudad5: AreaP (5,41,5,50)
  ciudad6: AreaP (6,51,6,60)
  ciudad7: AreaP (2,1,2,1)

robots
  robot robotJuntador
  variables
    f, id:numero
  comenzar
    f:=0
    RecibirMensaje(id, r7) {primero recibe el id del fiscalizador}
    recorrerArea(f) {recorre}
    EnviarMensaje(id, r7) {una vez que termina primero enviar el mensaje asincrono con su id al fiscalizador}
    EnviarMensaje(f, r7) {luego envia la cantidad de flores que junt√≥}
  fin
  robot robotFiscalizador
  variables
    max, f, idRobot, idGanador:numero
  comenzar
    asignarId
    idGanador:=0
    max:=0
    repetir 6
      RecibirMensaje(idRobot, *)
      si(idRobot = 1)
        RecibirMensaje(f, r1)
      sino
        si(idRobot = 2)
          RecibirMensaje(f, r2)
        sino  
          si(idRobot = 3)
            RecibirMensaje(f, r3)
          sino
            si(idRobot = 4)
              RecibirMensaje(f, r4)
            sino
              si(idRobot = 5)
                RecibirMensaje(f, r5)
              sino
                RecibirMensaje(f, r6)
      actualizarMaximo(f, max, idRobot, idGanador)
    informarGanador(idGanador)
  fin

variables
  r1:robotJuntador
  r2:robotJuntador
  r3:robotJuntador
  r4:robotJuntador
  r5:robotJuntador
  r6:robotJuntador
  r7:robotFiscalizador
comenzar
  AsignarArea(r1, ciudad1)
  AsignarArea(r2, ciudad2)
  AsignarArea(r3, ciudad3)
  AsignarArea(r4, ciudad4)
  AsignarArea(r5, ciudad5)
  AsignarArea(r6, ciudad6)
  AsignarArea(r7, ciudad7)
  {slaves}
  Iniciar(r1,1,1)
  Iniciar(r2,2,11)
  Iniciar(r3,3,21)
  Iniciar(r4,4,31)
  Iniciar(r5,5,41)
  Iniciar(r6,6,51)
  {robot jefe}
  Iniciar(r7,2,1)
fin